<head>
  <title>Magnet</title>
</head>

<body>
  <ul class="nav nav-tabs">
    {{> loginButtons}}
  </ul>
  <div class="container center-block">
    <div class="row">
      <h1>Topics</h1>
    </div>
    {{> topics}}
    <div class="row">
      <div class="col-sm-8">
        {{> people}}
      </div>
      <div class="col-sm-4">
        <div class="well">
          {{#if currentUser}}
            {{> me}}
          {{else}}
            <p>Please log-in/register to announce your presence</p>
          {{/if}}
        </div>
      </div>
    </div>
  </div>
</body>

<template name="me">
  <h2>My Profile</h2>
  <button>Take a Photo</button>
  {{#if photo}}
    <div>
      <img src={{photo}} class="img-thumbnail img-responsive"/>
    </div>
  {{/if}}
  <p>{{email}}</p>
  <form>
    <input type="text" name="name" placeholder="Name" value="{{profile.name}}" />
    <input type="submit" value="Save and Announce" />
  </form>
  <h2>My Topics</h2>
  {{#each topics}}
    {{> myTopic}}
  {{/each}}
</template>

<template name="myTopic">
  <div class="row">
    {{name}}
  </div>
</template>

<template name="topics">
  {{#if canVote}}
    <div class="row">
      {{#if availablePoints}}
        You have {{availablePoints}} points to assign to your favorite topics:
      {{/if}}
    </div>
  {{/if}}
  <ul class="list-group">
    {{#each topics}}
      {{> topic}}
    {{/each}}
  </ul>
  {{#if currentUser}}
    <div class="row">
      <div class="col-sm-12">
        <form role="form" class="form form-inline">
          <div class="form-group">
            <button type="submit" class="btn btn-default">Add</button>
            <input type="text" class="form-control" name="name" placeholder="New Topic" value="{{name}}" />
          </div>
        </form>
      </div>
    </div>
  {{/if}}
</template>

<template name="topic">
  <li class="list-group-item">
    <span class="badge">{{totalPoints}}</span>
    {{#if canUpvote}}
      <button class="btn btn-primary plusOne">+1</button>
    {{else}}
      <button class="btn btn-default disabled">+1</button>
    {{/if}}
    {{#if canDownvote}}
      <button class="btn btn-danger minusOne">-1</button>
    {{else}}
      <button class="btn btn-default disabled">-1</button>
    {{/if}}
    <span class="{{topicSize}}">{{name}}</span>
  </li>
</template>

<template name="people">
  <h2>Who's here?</h2>
  {{#each people}}
    {{> person}}
  {{/each}}
</template>

<template name="person">
  <div class="row">
    <div class="col-sm-4">
      {{#if photo}}
        <div>
          <img src={{photo}} class="img-thumbnail img-responsive"/>
        </div>
      {{/if}}
    </div>
    <div class="col-sm-8">
      <h3>{{profile.name}}</h3>
      <p><a href="mailto:{{profile.email}}">{{profile.email}}</a></p>
    </div>
  </div>
</template>
